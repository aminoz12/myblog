---
import Layout from '../layouts/Layout.astro';

// Mock categories data with detailed information
const categories = [
  {
    name: 'BDSM',
    slug: 'bdsm',
    description: 'D√©couvrez l\'univers fascinant du BDSM : bondage, domination, soumission, sadomasochisme et plus encore. Des guides de s√©curit√© essentiels et des pratiques responsables.',
    icon: 'üîó',
    color: 'from-red-500 to-red-700',
    bgColor: 'bg-red-500/20',
    borderColor: 'border-red-500/30',
    textColor: 'text-red-300',
    count: 8,
    featuredPosts: [
      'D√©couverte du BDSM : Guide Complet pour D√©butants',
      'BDSM : Protocoles de S√©curit√© Essentiels',
      'Le Bondage : Techniques et S√©curit√©'
    ],
    tags: ['Bondage', 'Domination', 'Soumission', 'S√©curit√©', 'Protocoles', 'Consentement']
  },
  {
    name: 'Libertinage',
    slug: 'libertinage',
    description: 'Explorez l\'art du libertinage moderne : √©thique, consentement, communication et exploration des plaisirs partag√©s dans un cadre respectueux et bienveillant.',
    icon: 'üíã',
    color: 'from-purple-500 to-purple-700',
    bgColor: 'bg-purple-500/20',
    borderColor: 'border-purple-500/30',
    textColor: 'text-purple-300',
    count: 6,
    featuredPosts: [
      'L\'Art du Libertinage Moderne : √âthique et Plaisir',
      'Premi√®re Exp√©rience Libertinage : Guide du D√©butant',
      'Libertinage en Couple : Communication et Confiance'
    ],
    tags: ['√âthique', 'Consentement', 'Plaisir', 'Communication', 'Confiance', 'Exploration']
  },
  {
    name: 'Roleplay',
    slug: 'roleplay',
    description: 'Plongez dans l\'art du roleplay avec des sc√©narios sophistiqu√©s, des techniques d\'immersion et des conseils pour cr√©er des exp√©riences intenses et m√©morables.',
    icon: 'üé≠',
    color: 'from-blue-500 to-blue-700',
    bgColor: 'bg-blue-500/20',
    borderColor: 'border-blue-500/30',
    textColor: 'text-blue-300',
    count: 4,
    featuredPosts: [
      'Sc√©narios de Roleplay Avanc√©s : Cr√©er l\'Intensit√©',
      'Roleplay pour D√©butants : Premiers Pas',
      'Costumes et Accessoires pour Roleplay'
    ],
    tags: ['Sc√©narios', 'Intensit√©', 'Cr√©ativit√©', 'Immersion', 'Costumes', 'Accessoires']
  },
  {
    name: 'Sex Toys',
    slug: 'sex-toys',
    description: 'Guide complet des sex toys : comment choisir, utiliser et int√©grer ces accessoires √©rotiques dans votre vie intime pour des exp√©riences plus riches et satisfaisantes.',
    icon: 'ü¶Ñ',
    color: 'from-pink-500 to-pink-700',
    bgColor: 'bg-pink-500/20',
    borderColor: 'border-pink-500/30',
    textColor: 'text-pink-300',
    count: 3,
    featuredPosts: [
      'Sex Toys : Guide Complet du Choix √† l\'Utilisation',
      'Les Meilleurs Sex Toys pour D√©butants',
      'Entretien et Hygi√®ne des Sex Toys'
    ],
    tags: ['Guide', 'Utilisation', 'Plaisir', 'Hygi√®ne', 'Entretien', 'Choix']
  },
  {
    name: 'Fantasmes',
    slug: 'fantasmes',
    description: 'Osez explorer vos fantasmes les plus profonds dans un cadre s√©curis√© et bienveillant. D√©couvrez comment partager et r√©aliser vos d√©sirs les plus intimes.',
    icon: '‚ú®',
    color: 'from-orange-500 to-orange-700',
    bgColor: 'bg-orange-500/20',
    borderColor: 'border-orange-500/30',
    textColor: 'text-orange-300',
    count: 5,
    featuredPosts: [
      'Fantasmes et Tabous : L\'Art de l\'Exploration Consciente',
      'Comment Partager ses Fantasmes avec son Partenaire',
      'Fantasmes BDSM : Exploration S√©curis√©e'
    ],
    tags: ['Tabous', 'Exploration', 'D√©couverte', 'Partage', 'R√©alisation', 'S√©curit√©']
  },
  {
    name: 'Communication',
    slug: 'communication',
    description: 'Ma√Ætrisez l\'art de la communication sexuelle : exprimer vos d√©sirs, √©tablir vos limites et cr√©er une intimit√© plus profonde et satisfaisante avec votre partenaire.',
    icon: 'üí¨',
    color: 'from-green-500 to-green-700',
    bgColor: 'bg-green-500/20',
    borderColor: 'border-green-500/30',
    textColor: 'text-green-300',
    count: 4,
    featuredPosts: [
      'Communication Sexuelle : Le Secret d\'une Vie √ârotique √âpanouie',
      'Comment Parler de ses D√©sirs sans G√™ne',
      'Communication dans le Couple : B√¢tir la Confiance'
    ],
    tags: ['Couple', 'D√©sirs', 'Intimit√©', 'Confiance', 'Expression', 'Limites']
  }
];

// Get search params for filtering
const { searchParams } = Astro.url;
const search = searchParams.get('search') || '';

// Filter categories based on search
let filteredCategories = categories;
if (search) {
  filteredCategories = categories.filter(cat => 
    cat.name.toLowerCase().includes(search.toLowerCase()) ||
    cat.description.toLowerCase().includes(search.toLowerCase()) ||
    cat.tags.some(tag => tag.toLowerCase().includes(search.toLowerCase()))
  );
}
---

<Layout 
  title="Cat√©gories - Mad2Moi Blog"
  description="Explorez nos cat√©gories de contenu sur l'exploration √©rotique, le BDSM, le libertinage et le bien-√™tre sexuel. Trouvez le contenu qui correspond √† vos int√©r√™ts."
>
  <!-- Hero Section -->
  <section class="relative py-20 overflow-hidden">
    <div class="absolute inset-0 bg-gradient-to-br from-secondary-900 via-primary-900 to-secondary-800">
      <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ec4899" fill-opacity="0.05"%3E%3Ccircle cx="30" cy="30" r="2"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-30"></div>
    </div>
    
    <div class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h1 class="text-5xl md:text-6xl font-bold text-white mb-6 font-elegant text-glow">
        Cat√©gories <span class="text-primary-400">Mad2Moi</span>
      </h1>
      <p class="text-xl text-secondary-300 mb-8 max-w-3xl mx-auto">
        Explorez nos diff√©rentes cat√©gories de contenu et trouvez ce qui vous int√©resse le plus
      </p>
      
      <!-- Search Bar -->
      <div class="max-w-2xl mx-auto mb-8">
        <form class="flex gap-4" method="GET">
          <input
            type="search"
            name="search"
            placeholder="Rechercher une cat√©gorie..."
            value={search}
            class="flex-1 px-6 py-4 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-transparent text-white placeholder-white/60 backdrop-blur-sm text-lg"
          />
          <button
            type="submit"
            class="px-8 py-4 bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white font-semibold rounded-lg transition-all duration-300 hover:scale-105"
          >
            üîç Rechercher
          </button>
        </form>
      </div>
      
      <!-- Active search filter -->
      {search && (
        <div class="flex justify-center mb-6">
          <div class="flex items-center gap-3">
            <span class="px-3 py-1 bg-primary-500/20 text-primary-300 rounded-full text-sm border border-primary-500/30">
              Recherche: {search}
            </span>
            <a href="/categories" class="px-3 py-1 bg-secondary-500/20 text-secondary-300 rounded-full text-sm border border-secondary-500/30 hover:bg-secondary-500/30 transition-colors">
              ‚úï Effacer
            </a>
          </div>
        </div>
      )}
    </div>
  </section>

  <!-- Categories Grid -->
  <section class="py-20 bg-gradient-to-b from-secondary-900 to-secondary-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      {filteredCategories.length > 0 ? (
        <>
          <div class="text-center mb-16">
            <h2 class="text-3xl font-bold text-white mb-4 font-elegant">
              {search ? `R√©sultats de recherche` : 'Toutes nos cat√©gories'}
            </h2>
            <p class="text-secondary-300">
              {filteredCategories.length} cat√©gorie{filteredCategories.length > 1 ? 's' : ''} trouv√©e{filteredCategories.length > 1 ? 's' : ''}
            </p>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            {filteredCategories.map((category) => (
              <div class="card-sensual hover:border-glow group transform hover:scale-105 transition-all duration-500">
                <!-- Category Header -->
                <div class="flex items-center gap-4 mb-6">
                  <div class={`w-16 h-16 bg-gradient-to-br ${category.color} rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300`}>
                    <span class="text-3xl">{category.icon}</span>
                  </div>
                  <div class="flex-1">
                    <h3 class="text-2xl font-bold text-white mb-2 font-elegant group-hover:text-primary-400 transition-colors">
                      {category.name}
                    </h3>
                    <div class="flex items-center gap-4">
                      <span class={`px-3 py-1 ${category.bgColor} ${category.textColor} rounded-full text-sm font-medium border ${category.borderColor}`}>
                        {category.count} article{category.count > 1 ? 's' : ''}
                      </span>
                      <a 
                        href={`/blog?category=${category.slug}`}
                        class="text-primary-400 hover:text-primary-300 text-sm font-medium transition-colors"
                      >
                        Voir tous les articles ‚Üí
                      </a>
                    </div>
                  </div>
                </div>
                
                <!-- Category Description -->
                <p class="text-secondary-300 mb-6 leading-relaxed">
                  {category.description}
                </p>
                
                <!-- Featured Posts -->
                <div class="mb-6">
                  <h4 class="text-white font-semibold mb-3">Articles populaires :</h4>
                  <ul class="space-y-2">
                    {category.featuredPosts.map((post) => (
                      <li class="flex items-center gap-2 text-secondary-300 hover:text-primary-300 transition-colors">
                        <span class="text-primary-400">‚Ä¢</span>
                        <span class="text-sm">{post}</span>
                      </li>
                    ))}
                  </ul>
                </div>
                
                <!-- Tags -->
                <div class="flex flex-wrap gap-2">
                  {category.tags.map((tag) => (
                    <span class={`px-2 py-1 ${category.bgColor} ${category.textColor} rounded text-xs border ${category.borderColor}`}>
                      {tag}
                    </span>
                  ))}
                </div>
                
                <!-- Explore Button -->
                <div class="mt-6 pt-6 border-t border-secondary-600/30">
                  <a 
                    href={`/blog?category=${category.slug}`}
                    class={`inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r ${category.color} text-white font-semibold rounded-lg hover:scale-105 transition-all duration-300 shadow-lg`}
                  >
                    <span>Explorer {category.name}</span>
                    <span class="group-hover:translate-x-1 transition-transform">‚Üí</span>
                  </a>
                </div>
              </div>
            ))}
          </div>
        </>
      ) : (
        <div class="text-center py-20">
          <div class="text-8xl mb-6 opacity-60">üîç</div>
          <h2 class="text-3xl font-bold text-white mb-4 font-elegant">
            Aucune cat√©gorie trouv√©e
          </h2>
          <p class="text-secondary-300 mb-8 max-w-md mx-auto">
            Aucune cat√©gorie ne correspond √† votre recherche. Essayez avec d'autres mots-cl√©s ou parcourez toutes nos cat√©gories.
          </p>
          <a href="/categories" class="btn-primary">
            üè∑Ô∏è Voir toutes les cat√©gories
          </a>
        </div>
      )}
    </div>
  </section>

  <!-- Quick Stats -->
  <section class="py-20 bg-gradient-to-b from-secondary-800 to-secondary-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <h2 class="text-3xl font-bold text-white mb-4 font-elegant">
          Statistiques du Blog
        </h2>
        <p class="text-secondary-300">
          D√©couvrez l'√©tendue de notre contenu √©ducatif
        </p>
      </div>
      
      <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
        <div class="text-center group">
          <div class="text-5xl mb-4 group-hover:scale-110 transition-transform duration-300">
            üìö
          </div>
          <div class="text-4xl font-bold text-white mb-2 text-glow">
            {categories.reduce((total, cat) => total + cat.count, 0)}+
          </div>
          <div class="text-secondary-400">Articles Totaux</div>
        </div>
        
        <div class="text-center group">
          <div class="text-5xl mb-4 group-hover:scale-110 transition-transform duration-300">
            üè∑Ô∏è
          </div>
          <div class="text-4xl font-bold text-white mb-2 text-glow">
            {categories.length}
          </div>
          <div class="text-secondary-400">Cat√©gories</div>
        </div>
        
        <div class="text-center group">
          <div class="text-5xl mb-4 group-hover:scale-110 transition-transform duration-300">
            ‚úçÔ∏è
          </div>
          <div class="text-4xl font-bold text-white mb-2 text-glow">
            3
          </div>
          <div class="text-secondary-400">Auteurs</div>
        </div>
        
        <div class="text-center group">
          <div class="text-5xl mb-4 group-hover:scale-110 transition-transform duration-300">
            üî•
          </div>
          <div class="text-4xl font-bold text-white mb-2 text-glow">
            100%
          </div>
          <div class="text-secondary-400">Contenu Mature</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Newsletter CTA -->
  <section class="py-20 bg-gradient-to-r from-primary-900 to-secondary-900">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-4xl font-bold text-white mb-6 font-elegant">
        Restez Inform√© des Derni√®res Tendances
      </h2>
      <p class="text-xl text-primary-200 mb-10 max-w-3xl mx-auto leading-relaxed">
        Recevez nos meilleurs articles directement dans votre bo√Æte mail. 
        <span class="text-white font-semibold">Pas de spam, juste du contenu de qualit√© pour adultes.</span>
      </p>
      
      <form class="max-w-md mx-auto flex gap-4 mb-6" id="categories-newsletter">
        <input
          type="email"
          placeholder="Votre adresse email"
          class="flex-1 px-4 py-3 bg-white/10 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-transparent text-white placeholder-white/60 backdrop-blur-sm"
          required
        />
        <button
          type="submit"
          class="px-6 py-3 bg-white text-primary-600 font-semibold rounded-lg hover:bg-primary-50 transition-colors duration-200"
        >
          S'abonner
        </button>
      </form>
      
      <p class="text-sm text-primary-200">
        En vous abonnant, vous acceptez notre 
        <a href="/privacy" class="underline hover:no-underline text-white">politique de confidentialit√©</a>.
      </p>
    </div>
  </section>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const categoriesNewsletter = document.getElementById('categories-newsletter');
    
    if (categoriesNewsletter) {
      categoriesNewsletter.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const formData = new FormData(e.target as HTMLFormElement);
        const email = formData.get('email') as string;
        
        if (!email) return;
        
        try {
          const response = await fetch('/api/newsletter/subscribe', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email }),
          });
          
          if (response.ok) {
            alert('Merci pour votre inscription ! Vous recevrez bient√¥t nos derniers articles.');
            (e.target as HTMLFormElement).reset();
          } else {
            alert('Une erreur est survenue. Veuillez r√©essayer.');
          }
        } catch (error) {
          console.error('Newsletter subscription error:', error);
          alert('Une erreur est survenue. Veuillez r√©essayer.');
        }
      });
    }
  });
</script>


